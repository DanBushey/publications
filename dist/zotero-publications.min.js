!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.ZoteroPublications=t()}}(function(){return function t(e,n,o){function r(a,l){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[a]={exports:{}};e[a][0].call(d.exports,function(t){var n=e[a][1][t];return r(n?n:t)},d,d.exports,t,e,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({"/srv/zotero/my-publications/src/js/api.js":[function(t,e,n){(function(e){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(t){for(var n=[],o={},r=t.length;r--;){var i=t[r];if(i.data&&i.data.abstractNote){var a=i.data.abstractNote.substr(0,e.shortenedAbstractLenght);a=a.substr(0,Math.min(a.length,a.lastIndexOf(" "))),i.data[u]=a}i.data&&i.data.parentItem&&(t.splice(r,1),n.push(i)),o[i.key]=i}var l=!0,d=!1,p=void 0;try{for(var f,c=n[Symbol.iterator]();!(l=(f=c.next()).done);l=!0){var i=f.value;o[i.data.parentItem]?(o[i.data.parentItem][s.CHILD_ITEMS_SYMBOL]||(o[i.data.parentItem][s.CHILD_ITEMS_SYMBOL]=[]),o[i.data.parentItem][s.CHILD_ITEMS_SYMBOL].push(i)):console.warn("item "+i.key+" has parentItem "+i.data.parentItem+" that does not exist in the dataset")}}catch(_){d=!0,p=_}finally{try{!l&&c["return"]&&c["return"]()}finally{if(d)throw p}}}return t}function i(t,e,n){var o=/<(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*))>;\s*rel="next"/;return n=n||[],new Promise(function(r,a){fetch(t,e).then(function(s){s.status>=200&&s.status<300?s.headers.has("Link")?!function(){var t=s.headers.get("Link").match(o);t&&t.length>=2?s.json().then(function(o){r(i(t[1],e,l["default"].union(n,o)))}):s.json().then(function(t){r(l["default"].union(n,t))})}():s.json().then(function(t){r(l["default"].union(n,t))}):a(new Error("Unexpected status code "+s.status+" when requesting "+t))})["catch"](function(){a(new Error("Unexpected error when requesting "+t))})})}Object.defineProperty(n,"__esModule",{value:!0}),n.processResponse=r,n.fetchUntilExhausted=i;var a="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,l=o(a),s=t("./data.js"),u=Symbol["for"]("abstractNoteShort");n.ABSTRACT_NOTE_SHORT_SYMBOL=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./data.js":"/srv/zotero/my-publications/src/js/data.js"}],"/srv/zotero/my-publications/src/js/data.js":[function(t,e,n){(function(e){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){this.raw=this.data=(0,l.processResponse)(t,e),this.grouped=s,Object.defineProperty(this,"length",{enumerable:!1,configurable:!1,get:function(){return this.data.length}})}Object.defineProperty(n,"__esModule",{value:!0}),n.ZoteroData=r;var i="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,a=o(i),l=t("./api.js"),s=0;n.GROUPED_NONE=s;var u=1;n.GROUPED_BY_TYPE=u;var d=2;n.GROUPED_BY_COLLECTION=d;var p=Symbol["for"]("childItems");n.CHILD_ITEMS_SYMBOL=p;var f=Symbol["for"]("groupExpanded");n.GROUP_EXPANDED_SUMBOL=f,r.prototype.groupByType=function(t){var e={};t=t||[];for(var n=this.raw.length;n--;){var o=this.raw[n];e[o.data.itemType]||(e[o.data.itemType]=[]),e[o.data.itemType].push(o),e[o.data.itemType][f]="all"===t||a["default"].contains(t,o.data.itemType)}this.data=e,this.grouped=u},r.prototype.groupByCollections=function(){throw new Error("groupByCollections is not implemented yet.")},r.prototype[Symbol.iterator]=function(){var t=this,e=0;if(!(this.grouped>0))return{next:function(){return{value:e<this.data.length?this.data[e]:null,done:e++>=this.data.length}}.bind(this)};var n=function(){var n=Object.keys(t.data);return{v:{next:function(){return{value:e<n.length?[n[e],this.data[n[e]]]:null,done:e++>=n.length}}.bind(t)}}}();return"object"==typeof n?n.v:void 0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./api.js":"/srv/zotero/my-publications/src/js/api.js"}],"/srv/zotero/my-publications/src/js/main-modern.js":[function(t,e,n){"use strict";var o=t("./main.js");e.exports=o.ZoteroPublications},{"./main.js":"/srv/zotero/my-publications/src/js/main.js"}],"/srv/zotero/my-publications/src/js/main.js":[function(t,e,n){(function(e){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function r(){return arguments.length<=1?void(this.config=a["default"].extend({},this.defaults,arguments?arguments[0]:{})):arguments.length<=3?(this.config=a["default"].extend({},this.defaults,arguments[2]),this.render(arguments[0],arguments[1])):Promise.reject(new Error("ZoteroPublications takes between one and three arguments. ${arguments.length} is too many."))}Object.defineProperty(n,"__esModule",{value:!0}),n.ZoteroPublications=r;var i="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,a=o(i),l=t("./render.js"),s=t("./api.js"),u=t("./data.js"),d=t("./ui.js");r.prototype.defaults={apiBase:"api.zotero.org",limit:100,citationStyle:"",include:["data","citation"],shortenedAbstractLenght:250,group:!1,expand:"all"},r.prototype.get=function(t){var e=this.config.apiBase,n=this.config.limit,o=this.config.citationStyle,r=this.config.include.join(","),i="https://"+e+"/"+t+"?include="+r+"&limit="+n+"&linkwrap=1&order=dateModified&sort=desc&start=0&style="+o,a={headers:{Accept:"application/json"}};return new Promise(function(t,e){var n=(0,s.fetchUntilExhausted)(i,a);n.then(function(e){var n=new u.ZoteroData(e,this.config);"type"===this.config.group&&n.groupByType(this.config.expand),t(n)}.bind(this)),n["catch"](e)}.bind(this))},r.prototype.render=function(t,e){return new Promise(function(n,o){if(e instanceof HTMLElement||o(new Error("Second argument to render() method must be a DOM element")),t instanceof u.ZoteroData){var r=t;(0,l.renderPublications)(e,r),n()}else if("string"==typeof t){var i=t;(0,d.toggleSpinner)(e,!0);var a=this.get(i);a.then(function(t){(0,d.toggleSpinner)(e,!1),(0,l.renderPublications)(e,t),n()}),a["catch"](function(){(0,d.toggleSpinner)(e,!1),o(arguments[0])})}else o(new Error("First argument to render() method must be an endpoint or an instance of ZoteroData"))}.bind(this))},r.ZoteroData=u.ZoteroData}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./api.js":"/srv/zotero/my-publications/src/js/api.js","./data.js":"/srv/zotero/my-publications/src/js/data.js","./render.js":"/srv/zotero/my-publications/src/js/render.js","./ui.js":"/srv/zotero/my-publications/src/js/ui.js"}],"/srv/zotero/my-publications/src/js/render.js":[function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){return(0,c["default"])({item:t,data:t.data,childItemsMarkup:e||""})}function i(t){var e="",n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value,d=l(u);e+=r(u,d)}}catch(p){o=!0,i=p}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw i}}return(0,y["default"])({zoteroItems:e})}function a(t){return(0,z["default"])({item:t})}function l(t){var e="";if(t[I.CHILD_ITEMS_SYMBOL]&&t[I.CHILD_ITEMS_SYMBOL].length>0){var n=!0,o=!1,r=void 0;try{for(var i,l=t[I.CHILD_ITEMS_SYMBOL][Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var s=i.value;e+=a(s)}}catch(u){o=!0,r=u}finally{try{!n&&l["return"]&&l["return"]()}finally{if(o)throw r}}}return(0,v["default"])({childItemsMarkup:e})}function s(t,e,n){return(0,m["default"])({title:t,itemsMarkup:n,expand:e})}function u(t){var e="",n=!0,o=!1,r=void 0;try{for(var a,l=t[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var u=p(a.value,2),d=u[0],f=u[1],c=i(f),_=f[I.GROUP_EXPANDED_SUMBOL];e+=s(d,_,c)}}catch(y){o=!0,r=y}finally{try{!n&&l["return"]&&l["return"]()}finally{if(o)throw r}}return(0,h["default"])({groupsMarkup:e})}function d(t,e){var n;n=e.grouped>0?u(e)+(0,S["default"])():i(e)+(0,S["default"])(),t.innerHTML=n,(0,M.addHandlers)(t)}Object.defineProperty(n,"__esModule",{value:!0});var p=function(){function t(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,l=t[Symbol.iterator]();!(o=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(s){r=!0,i=s}finally{try{!o&&l["return"]&&l["return"]()}finally{if(r)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();n.renderItem=r,n.renderItems=i,n.renderChildItem=a,n.renderChildItems=l,n.renderGroup=s,n.renderGrouped=u,n.renderPublications=d;var f=t("./tpl/item.tpl"),c=o(f),_=t("./tpl/items.tpl"),y=o(_),b=t("./tpl/group.tpl"),m=o(b),g=t("./tpl/groups.tpl"),h=o(g),w=t("./tpl/child-items.tpl"),v=o(w),j=t("./tpl/child-item.tpl"),z=o(j),x=t("./tpl/branding.tpl"),S=o(x),M=t("./ui.js"),I=t("./data.js")},{"./data.js":"/srv/zotero/my-publications/src/js/data.js","./tpl/branding.tpl":"/srv/zotero/my-publications/src/js/tpl/branding.tpl","./tpl/child-item.tpl":"/srv/zotero/my-publications/src/js/tpl/child-item.tpl","./tpl/child-items.tpl":"/srv/zotero/my-publications/src/js/tpl/child-items.tpl","./tpl/group.tpl":"/srv/zotero/my-publications/src/js/tpl/group.tpl","./tpl/groups.tpl":"/srv/zotero/my-publications/src/js/tpl/groups.tpl","./tpl/item.tpl":"/srv/zotero/my-publications/src/js/tpl/item.tpl","./tpl/items.tpl":"/srv/zotero/my-publications/src/js/tpl/items.tpl","./ui.js":"/srv/zotero/my-publications/src/js/ui.js"}],"/srv/zotero/my-publications/src/js/tpl/branding.tpl":[function(require,module,exports){(function(global){"undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null;module.exports=function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="zotero-branding">\n	Powered by <span class="zotero-logo"></span>\n</div>';return __p}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],"/srv/zotero/my-publications/src/js/tpl/child-item.tpl":[function(require,module,exports){(function(global){var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null;module.exports=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="<li>\n	"+(null==(__t=item.data.key)?"":_.escape(__t))+": "+(null==(__t=item.data.itemType)?"":_.escape(__t))+" \n</li>";return __p}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],"/srv/zotero/my-publications/src/js/tpl/child-items.tpl":[function(require,module,exports){(function(global){"undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null;module.exports=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<ul class="zotero-child-items">\n	'+(null==(__t=childItemsMarkup)?"":__t)+"\n</ul>";return __p}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],"/srv/zotero/my-publications/src/js/tpl/group.tpl":[function(require,module,exports){(function(global){var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null;module.exports=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<li class="zotero-group'+(null==(__t=expand?" zotero-group-expanded":"")?"":_.escape(__t))+'" aria-expanded="'+(null==(__t=expand?" true":"false")?"":_.escape(__t))+'" >\n	<h3 class="zotero-group-title">'+(null==(__t=title)?"":_.escape(__t))+"</h3>\n	"+(null==(__t=itemsMarkup)?"":__t)+"\n</li>";return __p}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],"/srv/zotero/my-publications/src/js/tpl/groups.tpl":[function(require,module,exports){(function(global){"undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null;module.exports=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<ul class="zotero-groups">\n	'+(null==(__t=groupsMarkup)?"":__t)+"\n</ul>";return __p}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],"/srv/zotero/my-publications/src/js/tpl/item.tpl":[function(require,module,exports){(function(global){var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null;module.exports=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<li class="zotero-item zotero-'+(null==(__t=data.itemType)?"":_.escape(__t))+'">\n	'+(null==(__t=item.citation)?"":__t)+"\n	",data[Symbol["for"]("abstractNoteShort")]&&data[Symbol["for"]("abstractNoteShort")].length&&(__p+='\n    	<p class="zotero-abstract-short">\n    		'+(null==(__t=data[Symbol["for"]("abstractNoteShort")])?"":_.escape(__t))+'\n    		<a class="zotero-abstract-toggle" aria-controls="za-'+(null==(__t=item.key)?"":_.escape(__t))+'">...</a>\n    	</p>\n	'),__p+="\n	",data.abstractNote&&data.abstractNote.length&&(__p+='\n    	<p id="za-'+(null==(__t=item.key)?"":_.escape(__t))+'" class="zotero-abstract" aria-expanded="false">\n    		'+(null==(__t=data.abstractNote)?"":_.escape(__t))+'\n    		<a class="zotero-abstract-toggle">...</a>\n    	</p>\n	'),__p+="\n    "+(null==(__t=childItemsMarkup)?"":__t)+"\n</li>";return __p}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],"/srv/zotero/my-publications/src/js/tpl/items.tpl":[function(require,module,exports){(function(global){"undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null;module.exports=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<ul class="zotero-items">\n	'+(null==(__t=zoteroItems)?"":__t)+"\n</ul>";return __p}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],"/srv/zotero/my-publications/src/js/ui.js":[function(t,e,n){"use strict";function o(t){t.addEventListener("click",function(t){if(t.target.classList.contains("zotero-abstract-toggle")){var e=t.target.parentNode.parentNode.querySelector(".zotero-abstract-short"),n=t.target.parentNode.parentNode.querySelector(".zotero-abstract"),o=e.classList.toggle("zotero-abstract-expanded");n.setAttribute("aria-expanded",o?"true":"false")}if(t.target.classList.contains("zotero-group-title")){var r=t.target.parentNode,o=r.classList.toggle("zotero-group-expanded");r.setAttribute("aria-expanded",o?"true":"false")}})}function r(t,e){var n=null===e?t.classList.toggle:e?t.classList.add:t.classList.remove;n.call(t.classList,"zotero-loading")}Object.defineProperty(n,"__esModule",{value:!0}),n.addHandlers=o,n.toggleSpinner=r},{}]},{},["/srv/zotero/my-publications/src/js/main-modern.js"])("/srv/zotero/my-publications/src/js/main-modern.js")});